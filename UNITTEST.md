# Юнит-тесты проекта

## Описание

В проекте реализованы юнит-тесты для основных сервисов и бизнес-логики:

- **ContactValidationServiceTest** — тесты для сервиса валидации контактов
- **ContactNotificationFormatterTest** — тесты для форматирования уведомлений о контактах
- **TelegramServiceTest** — тесты для сервиса отправки уведомлений в Telegram

### Охват тестами

#### ContactValidationServiceTest
- Проверка успешной валидации данных при создании контакта
- Проверка ошибки при неуникальном email
- Проверка ошибки при отсутствии обязательных полей
- Проверка успешной валидации при обновлении контакта с тем же email

#### ContactNotificationFormatterTest
- Проверка корректного форматирования сообщения о создании контакта
- Проверка корректного форматирования сообщения об обновлении контакта с тегами

#### TelegramServiceTest
- Проверка, что сервис возвращает false, если отправка уведомлений отключена через конфиг

## Как запускать юнит-тесты

1. **Убедитесь, что у вас настроено тестовое окружение**
   - В файле `.env.testing` должна быть настроена отдельная база данных для тестов
   - Пример:
     ```env
     DB_CONNECTION=sqlite
     DB_DATABASE=:memory:
     ```

2. **Запустите миграции для тестовой базы (опционально, если не используется in-memory):**
   ```bash
   php artisan migrate --env=testing
   ```

3. **Запуск всех юнит-тестов:**
   ```bash
   php artisan test --testsuite=Unit
   ```
   или просто:
   ```bash
   php artisan test
   ```

4. **Запуск конкретного теста:**
   ```bash
   php artisan test --filter=ContactValidationServiceTest
   ```

5. **Получение покрытия кода:**
   ```bash
   php artisan test --coverage
   ```

## Структура тестов

- Все юнит-тесты располагаются в каталоге `tests/Unit/Services/`
- Для моделей используются фабрики (см. `database/factories/ContactFactory.php`, `TagFactory.php`)
- Для тестов используется современный синтаксис атрибутов (`#[Test]`)

## Рекомендации
- Перед запуском тестов убедитесь, что база данных для тестов пуста или используется in-memory SQLite
- Для интеграционных тестов используйте отдельный suite или каталог `Feature`
- Для новых сервисов и бизнес-логики обязательно добавляйте тесты по аналогии с существующими

---

Если возникнут вопросы по тестированию или потребуется добавить новые тесты — обращайтесь! 